{
  "app-id": "com.leinardi.gst",
  "command": "gst",
  "runtime": "org.gnome.Platform",
  "runtime-version": "3.34",
  "sdk": "org.gnome.Sdk",
  "finish-args": [
    "--share=ipc",
    "--socket=x11",
    "--device=dri",
    "--share=network",
    "--talk-name=org.freedesktop.Flatpak",
    "--filesystem=/sys:ro",
    "--env=PATH=/usr/bin:/bin:/usr/sbin:/sbin:/app/bin:/app/sbin",
    "--env=LD_LIBRARY_PATH=/app/lib/x86_64-linux-gnu/:/app/lib/i386-linux-gnu/:/app/lib64:/app/lib"
  ],
  "modules": [
    {
      "name": "lm-sensors",
      "buildsystem": "simple",
      "build-commands": [
        "sed -i -e 's/ -g / -s /' Makefile",
        "make -j $FLATPAK_BUILDER_N_JOBS",
        "find . -type f | perl -lne 'print if -B and -x' | xargs strip",
        "make install BUILD_STATIC_LIB=0 DEBUG=0 PREFIX=/ DESTDIR=$FLATPAK_DEST"
      ],
      "sources": [
        {
          "type": "git",
          "url": "https://github.com/lm-sensors/lm-sensors.git",
          "tag": "V3-5-0",
          "commit": "e8afbda10fba571c816abddcb5c8180afc435bba"
        }
      ]
    },
    {
      "name": "libaio",
      "config-opts": [
        "--buildtype=debugoptimized"
      ],
      "buildsystem": "simple",
      "build-commands": [
        "make prefix=$FLATPAK_DEST install"
      ],
      "sources": [
        {
          "type": "git",
          "url": "https://pagure.io/libaio.git",
          "tag": "libaio-0.3.111",
          "commit": "f66be22ab0a59a39858900ab72a8c6a6e8b0b7ec"
        }
      ]
    },
    {
      "name": "libbsd",
      "sources": [
        {
          "type": "archive",
          "url": "https://www.gnupg.org/ftp/gcrypt/libgcrypt/libgcrypt-1.8.4.tar.bz2",
          "sha256": "f638143a0672628fde0cad745e9b14deb85dffb175709cacc1f4fe24b93f2227"
        }
      ]
    },
    {
      "name": "libgcrypt",
      "sources": [
        {
          "type": "git",
          "url": "https://gitlab.freedesktop.org/libbsd/libbsd.git",
          "tag": "0.10.0",
          "commit": "a11c98a6b5f57666260a5a4792404d81d59e418d"
        }
      ]
    },
    {
      "name": "zlib",
      "sources": [
        {
          "type": "archive",
          "url": "https://zlib.net/zlib-1.2.11.tar.gz",
          "sha256": "c3e5e9fdd5004dcb542feda5ee4f0ff0744628baf8ed2dd5d66f8ca1197cb1a1"
        }
      ]
    },
    {
      "name": "stress-ng",
      "buildsystem": "simple",
      "build-commands": [
        "make -j $FLATPAK_BUILDER_N_JOBS",
        "cp stress-ng $FLATPAK_DEST/bin/"
      ],
      "sources": [
        {
          "type": "git",
          "url": "git://kernel.ubuntu.com/cking/stress-ng.git",
          "tag": "V0.10.16",
          "commit": "1ad237fb9285333d70d19f6fd1fe236dbecaedce"
        }
      ]
    },
    {
      "name": "python-setuptools_scm",
      "buildsystem": "simple",
      "build-commands": [
        "python3 setup.py install --prefix=/app --root=/"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://files.pythonhosted.org/packages/09/b4/d148a70543b42ff3d81d57381f33104f32b91f970ad7873f463e75bf7453/setuptools_scm-3.1.0.tar.gz",
          "sha256": "1191f2a136b5e86f7ca8ab00a97ef7aef997131f1f6d4971be69a1ef387d8b40"
        },
        {
          "type": "shell",
          "commands": [
            "sed -i 's/if not platform_/if not dirs/' setup.py"
          ]
        }
      ]
    },
    {
      "name": "python3-python-dateutil",
      "buildsystem": "simple",
      "build-commands": [
        "python3 setup.py install --prefix=/app --root=/"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://files.pythonhosted.org/packages/0e/01/68747933e8d12263d41ce08119620d9a7e5eb72c876a3442257f74490da0/python-dateutil-2.7.5.tar.gz",
          "sha256": "88f9287c0174266bb0d8cedd395cfba9c58e87e5ad86b2ce58859bc11be3cf02"
        },
        {
          "type": "shell",
          "commands": [
            "sed -i 's/if not platform_/if not dirs/' setup.py"
          ]
        }
      ]
    },
    "pypi-dependencies.json",
    {
      "name": "gst",
      "buildsystem": "meson",
      "config-opts": [
        "--buildtype=release"
      ],
      "sources": [
        {
          "type": "git",
          "url": "https://gitlab.com/leinardi/gst.git",
          "tag": "0.5.0",
          "commit": "97fded41819fed44c78ce2e1dabf738c21aebb0c"
        }
      ]
    }
  ]
}
